-- Glyph.lua
-- @Author : Dencer (tdaddon@163.com)
-- @Link   : https://dengsir.github.io
-- @Date   : 2022/9/25 12:56:20
--
---@class ns
local ns = select(2, ...)

local GLYPH_SLOTS = {
    [1] = { id = 21, level = 15 },
    [2] = { id = 22, level = 15 },
    [3] = { id = 23, level = 50 },
    [4] = { id = 24, level = 30 },
    [5] = { id = 25, level = 70 },
    [6] = { id = 26, level = 80 },
}

local GLYPHS_DATA = {
    -- from https://wago.tools/db2/GlyphProperties/csv?build=3.4.3.52237
    -- glyphId, spellId, icon
    { 2,    52084,  237634 },
    { 21,   12320,  0 },
    { 22,   12297,  0 },
    { 61,   46831,  0 },
    { 81,   52084,  0 },
    { 82,   52085,  0 },
    { 101,  0,      0 },
    { 121,  46487,  132371 },
    { 141,  54292,  237637 },
    { 161,  54810,  237636 },
    { 162,  54811,  237635 },
    { 163,  54812,  237651 },
    { 164,  54813,  237646 },
    { 165,  54815,  237652 },
    { 166,  54818,  237633 },
    { 167,  54821,  237650 },
    { 168,  54824,  237645 },
    { 169,  54832,  237644 },
    { 170,  54733,  237649 },
    { 171,  54743,  237634 },
    { 172,  54754,  237647 },
    { 173,  54825,  237641 },
    { 174,  54826,  237642 },
    { 175,  54845,  237639 },
    { 176,  54830,  237643 },
    { 177,  54831,  237640 },
    { 178,  54828,  237638 },
    { 179,  54756,  237648 },
    { 180,  54829,  237632 },
    { 181,  54760,  237637 },
    { 182,  54912,  0 },
    { 183,  54922,  237650 },
    { 184,  54925,  237644 },
    { 185,  54923,  237633 },
    { 186,  54924,  237637 },
    { 187,  54926,  237639 },
    { 188,  54927,  237632 },
    { 189,  54928,  237641 },
    { 190,  54929,  237640 },
    { 191,  54930,  237647 },
    { 192,  54931,  237651 },
    { 193,  54934,  237643 },
    { 194,  54935,  237648 },
    { 195,  54936,  237649 },
    { 196,  54937,  237652 },
    { 197,  54938,  237635 },
    { 198,  54939,  237636 },
    { 199,  54940,  237646 },
    { 200,  54943,  237645 },
    { 211,  55436,  237639 },
    { 212,  55437,  237640 },
    { 213,  55449,  237636 },
    { 214,  55454,  237638 },
    { 215,  55442,  237646 },
    { 216,  55439,  237652 },
    { 217,  55455,  237642 },
    { 218,  55450,  237635 },
    { 219,  55447,  237647 },
    { 220,  55451,  237637 },
    { 221,  55443,  237643 },
    { 222,  55456,  237649 },
    { 223,  55440,  237651 },
    { 224,  55438,  237633 },
    { 225,  55448,  237648 },
    { 226,  55453,  237641 },
    { 227,  55441,  237644 },
    { 228,  55446,  237645 },
    { 229,  55444,  237632 },
    { 230,  55452,  237634 },
    { 231,  55445,  237650 },
    { 251,  55675,  237634 },
    { 252,  55677,  237633 },
    { 253,  55684,  237635 },
    { 254,  55678,  237639 },
    { 255,  55679,  237637 },
    { 256,  55683,  237652 },
    { 257,  55686,  237641 },
    { 258,  55673,  237651 },
    { 259,  55691,  237642 },
    { 260,  55688,  237644 },
    { 261,  55681,  237650 },
    { 262,  55689,  237636 },
    { 263,  55672,  237647 },
    { 264,  55680,  237645 },
    { 265,  55676,  237648 },
    { 266,  55674,  237632 },
    { 267,  55690,  237640 },
    { 268,  55682,  237638 },
    { 269,  55687,  237643 },
    { 270,  55692,  237649 },
    { 271,  55685,  237646 },
    { 272,  56242,  237650 },
    { 273,  56235,  237644 },
    { 274,  56218,  237647 },
    { 275,  56241,  237646 },
    { 276,  56232,  237634 },
    { 277,  56244,  237637 },
    { 278,  56246,  237638 },
    { 279,  56249,  237636 },
    { 280,  56238,  237635 },
    { 281,  56224,  237648 },
    { 282,  56217,  237645 },
    { 283,  56228,  237651 },
    { 284,  56248,  237641 },
    { 285,  56226,  237649 },
    { 286,  56240,  237632 },
    { 287,  56229,  237639 },
    { 288,  56216,  237640 },
    { 289,  56231,  237633 },
    { 290,  56250,  237652 },
    { 291,  56233,  237642 },
    { 292,  56247,  237643 },
    { 311,  56360,  237635 },
    { 312,  56363,  237637 },
    { 313,  56381,  237650 },
    { 314,  56365,  237641 },
    { 315,  56380,  237632 },
    { 316,  56368,  237651 },
    { 317,  56369,  237646 },
    { 318,  56376,  237647 },
    { 319,  56370,  237634 },
    { 320,  56384,  237648 },
    { 321,  56372,  237633 },
    { 322,  56377,  237644 },
    { 323,  56374,  237643 },
    { 324,  56371,  237649 },
    { 325,  56366,  237645 },
    { 326,  56383,  237652 },
    { 327,  56367,  237639 },
    { 328,  56382,  237640 },
    { 329,  56375,  237638 },
    { 330,  56364,  237642 },
    { 331,  56373,  237636 },
    { 351,  56824,  237647 },
    { 352,  56841,  237648 },
    { 353,  56857,  237635 },
    { 354,  56833,  237637 },
    { 355,  56851,  237641 },
    { 356,  56830,  237632 },
    { 357,  56850,  237643 },
    { 358,  56844,  237649 },
    { 359,  56845,  237633 },
    { 360,  56847,  237639 },
    { 361,  56829,  237652 },
    { 362,  56846,  237650 },
    { 363,  56856,  237636 },
    { 364,  56836,  237640 },
    { 365,  56828,  237644 },
    { 366,  56832,  237645 },
    { 367,  56849,  237646 },
    { 368,  56826,  237651 },
    { 369,  56842,  237634 },
    { 370,  56838,  237638 },
    { 371,  56848,  237642 },
    { 391,  56808,  237634 },
    { 392,  56813,  237650 },
    { 393,  56800,  237647 },
    { 394,  56818,  237645 },
    { 395,  56820,  237636 },
    { 396,  56806,  237638 },
    { 397,  56799,  237648 },
    { 398,  56802,  237635 },
    { 399,  56803,  237637 },
    { 400,  56804,  237652 },
    { 401,  56812,  237641 },
    { 402,  56814,  237640 },
    { 403,  56809,  237632 },
    { 404,  56807,  237646 },
    { 405,  56819,  237651 },
    { 406,  56801,  237644 },
    { 407,  56798,  237643 },
    { 408,  56805,  237642 },
    { 409,  56821,  237649 },
    { 410,  56810,  237633 },
    { 411,  56811,  237639 },
    { 431,  57856,  237645 },
    { 432,  57858,  237641 },
    { 433,  57855,  237635 },
    { 434,  57857,  237650 },
    { 435,  57862,  237632 },
    { 436,  58133,  237635 },
    { 438,  58132,  237638 },
    { 439,  57866,  237641 },
    { 440,  57870,  237636 },
    { 441,  57903,  237642 },
    { 442,  57902,  237642 },
    { 443,  57904,  237646 },
    { 444,  57900,  237650 },
    { 445,  57924,  237652 },
    { 446,  57926,  237647 },
    { 447,  57927,  237637 },
    { 448,  57928,  237633 },
    { 449,  58136,  237638 },
    { 450,  52648,  237639 },
    { 451,  57925,  237644 },
    { 452,  57937,  237646 },
    { 453,  57958,  237643 },
    { 454,  57979,  237645 },
    { 455,  57955,  237634 },
    { 456,  57947,  237651 },
    { 457,  57954,  237632 },
    { 458,  57985,  237651 },
    { 459,  57987,  237645 },
    { 460,  58009,  237640 },
    { 461,  57986,  237633 },
    { 462,  58015,  237652 },
    { 463,  58228,  237641 },
    { 464,  58032,  237635 },
    { 465,  58027,  237649 },
    { 466,  58017,  237637 },
    { 467,  58033,  237647 },
    { 468,  58039,  237652 },
    { 469,  58038,  237638 },
    { 470,  58058,  237640 },
    { 471,  58135,  237648 },
    { 472,  58134,  237648 },
    { 473,  58059,  237644 },
    { 474,  58055,  237639 },
    { 475,  58063,  237634 },
    { 476,  58057,  237643 },
    { 477,  58079,  237648 },
    { 478,  58070,  237649 },
    { 479,  58081,  237636 },
    { 480,  58080,  237637 },
    { 481,  58107,  237648 },
    { 482,  58094,  237640 },
    { 483,  58095,  237632 },
    { 484,  58096,  237646 },
    { 485,  58097,  237647 },
    { 486,  58099,  237648 },
    { 487,  58098,  237643 },
    { 488,  58104,  237639 },
    { 489,  58368,  237640 },
    { 490,  58369,  237636 },
    { 491,  58355,  237647 },
    { 492,  58366,  237633 },
    { 493,  58388,  237646 },
    { 494,  58367,  237639 },
    { 495,  58372,  237637 },
    { 496,  58357,  237648 },
    { 497,  58377,  237651 },
    { 498,  58365,  237649 },
    { 499,  58386,  237632 },
    { 500,  58385,  237635 },
    { 501,  58364,  237643 },
    { 502,  58375,  237644 },
    { 503,  58376,  237634 },
    { 504,  58387,  237641 },
    { 505,  58384,  237652 },
    { 506,  58353,  237638 },
    { 507,  58356,  237642 },
    { 508,  58382,  237645 },
    { 509,  58370,  237650 },
    { 511,  58613,  237634 },
    { 512,  58623,  237642 },
    { 513,  58616,  237636 },
    { 514,  58640,  237636 },
    { 515,  58673,  237647 },
    { 516,  58620,  237640 },
    { 518,  58677,  237651 },
    { 519,  62259,  237648 },
    { 520,  58629,  237645 },
    { 521,  58647,  237635 },
    { 522,  58680,  237638 },
    { 523,  58625,  237651 },
    { 524,  58631,  237637 },
    { 525,  58671,  237646 },
    { 526,  58657,  237641 },
    { 527,  58686,  237645 },
    { 528,  58669,  237638 },
    { 529,  58642,  237632 },
    { 530,  58618,  237644 },
    { 531,  58635,  237643 },
    { 532,  58676,  237649 },
    { 551,  59219,  237633 },
    { 552,  59289,  237634 },
    { 553,  59309,  237635 },
    { 554,  59307,  237650 },
    { 555,  60200,  237649 },
    { 556,  59327,  237633 },
    { 557,  59332,  237639 },
    { 558,  59336,  237650 },
    { 559,  56420,  237634 },
    { 560,  56414,  237642 },
    { 561,  56416,  237638 },
    { 571,  60200,  237652 },
    { 591,  61205,  237647 },
    { 611,  62126,  237652 },
    { 612,  62132,  237650 },
    { 613,  62135,  237634 },
    { 631,  62080,  237634 },
    { 651,  62210,  237648 },
    { 671,  62969,  237632 },
    { 672,  62970,  237633 },
    { 673,  62971,  237634 },
    { 674,  63055,  237635 },
    { 675,  63056,  237636 },
    { 676,  63057,  237637 },
    { 677,  63065,  237638 },
    { 691,  63066,  237639 },
    { 692,  63067,  237640 },
    { 693,  63068,  237641 },
    { 694,  63069,  237642 },
    { 695,  63086,  237643 },
    { 696,  63090,  237644 },
    { 697,  63091,  237645 },
    { 698,  63092,  237646 },
    { 699,  63093,  237647 },
    { 700,  63095,  237648 },
    { 701,  63218,  237649 },
    { 702,  63219,  237650 },
    { 703,  63220,  237651 },
    { 704,  63222,  237652 },
    { 705,  63223,  237632 },
    { 706,  63224,  237633 },
    { 707,  63225,  237634 },
    { 708,  63229,  237635 },
    { 709,  63231,  237636 },
    { 710,  63235,  237637 },
    { 711,  63237,  237638 },
    { 712,  63246,  237639 },
    { 713,  63248,  237640 },
    { 714,  63249,  237641 },
    { 715,  63252,  237642 },
    { 716,  63253,  237643 },
    { 731,  63254,  237644 },
    { 732,  63256,  237645 },
    { 733,  63268,  237646 },
    { 734,  63269,  237647 },
    { 735,  63270,  237648 },
    { 736,  63271,  237649 },
    { 737,  63273,  237650 },
    { 751,  63279,  237651 },
    { 752,  63280,  237652 },
    { 753,  63291,  237632 },
    { 754,  63298,  237633 },
    { 755,  63302,  237634 },
    { 756,  63303,  237635 },
    { 757,  63304,  237636 },
    { 758,  63309,  237637 },
    { 759,  63310,  237638 },
    { 760,  63320,  237639 },
    { 761,  63312,  237640 },
    { 762,  63324,  237641 },
    { 763,  63325,  237642 },
    { 764,  63326,  237643 },
    { 765,  63327,  237644 },
    { 766,  63328,  237645 },
    { 767,  63329,  237646 },
    { 768,  63330,  237647 },
    { 769,  63331,  237648 },
    { 770,  63332,  237649 },
    { 771,  63333,  237650 },
    { 772,  63334,  237651 },
    { 773,  63335,  237652 },
    { 791,  64199,  237652 },
    { 811,  65243,  237639 },
    { 831,  67598,  237643 },
    { 851,  68164,  237640 },
    { 871,  70937,  237641 },
    { 891,  71013,  237633 },
    { 911,  70947,  237651 },
    { 1436, 405004, 237641 },
    { 1437, 413895, 237635 },
    { 1438, 414812, 237636 },
}

local SPELL_GLYPHS = {}
local GLYPHS = {}

for glyphId, v in pairs(GLYPHS_DATA) do
    local item = {
        glyphId = v[1],
        spellId = v[2],
        icon = v[3],
    }

    if item.spellId > 0 then
        SPELL_GLYPHS[item.spellId] = item
    end
    GLYPHS[item.glyphId] = item
end

function ns.GetGlyphIdBySpellId(spellId)
    local d = SPELL_GLYPHS[spellId]
    return d and d.glyphId
end

function ns.GetGlyphIcon(glyphId)
    local d = GLYPHS[glyphId]
    return d and d.icon
end

function ns.GetGlyphInfo(glyphId)
    local d = GLYPHS[glyphId]
    if not d then
        return
    end
    return nil, d.spellId, d.icon
end

function ns.GetGlyphSlotRequireLevel(slot)
    local d = GLYPH_SLOTS[slot]
    return d and d.level
end

function ns.GetGlyphSlotId(slot)
    local d = GLYPH_SLOTS[slot]
    return d and d.id
end
